//devin87@qq.com
//build:2017/02/09 08:58:50
!function(e,t){"use strict";function n(e,n){return e!==t?e:n}function i(e){return"[object Function]"===L.call(e)}function r(e){return"number"==typeof e&&e>0&&e===Math.floor(e)}function a(e,t){return i(e)?e.apply(t,O.call(arguments,2)):void 0}function s(e,n,i){if(!e||!n)return e;for(var r in n)r!=t&&k.call(n,r)&&(i||e[r]===t)&&(e[r]=n[r]);return e}function o(e,t){if(t!==!1&&!/^[\],:{}\s]*$/.test(e.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))throw new Error("JSON SyntaxError");try{return new Function("return "+e)()}catch(n){}}function l(e,n){1>=n&&(n*=100),e.style.opacity!=t?e.style.opacity=n/100:e.style.filter!=t&&(e.style.filter="alpha(opacity="+parseInt(n)+")")}function u(e,t){var n=0,i=0,r=e.offsetWidth,a=e.offsetHeight;do n+=e.offsetLeft,i+=e.offsetTop,e=e.offsetParent;while(e&&e!=t);return{left:n,top:i,width:r,height:a}}function c(e,t,n,i){for(var r=e[n||t],a=[];r;){if(1==r.nodeType){if(!i)return r;a.push(r)}r=r[t]}return i?a:null}function d(e){return e.previousElementSibling||c(e,"previousSibling",null,!1)}function f(e){return e.nextElementSibling||c(e,"nextSibling",null,!1)}function p(e){return e.firstElementChild||c(e,"nextSibling","firstChild",!1)}function v(e){return e.lastElementChild||c(e,"previousSibling","lastChild",!1)}function h(e){return e.children||c(e,"nextSibling","firstChild",!0)}function m(e,t,n){var i=document.createElement(e);return t&&(i.className=t),n&&(i.innerHTML=n),i}function g(e,t){var n=m("div","",e);return t?n.childNodes:p(n)}function y(t){var n=t||e.event;return n.target||(n.target=n.srcElement),n}function w(e,t,n,i){var r=function(a){n.call(e,y(a)),i&&Q(e,t,r)};return N(e,t,r),i?void 0:{stop:function(){Q(e,t,r)}}}function x(e,t){if(i(e[t]))e[t]();else if(e.fireEvent)e.fireEvent("on"+t);else if(e.dispatchEvent){var n=document.createEvent("HTMLEvents");n.initEvent(t,!0,!0),e.dispatchEvent(n)}}function E(e,t,n){var i=y(e);t!==!1&&(i.preventDefault?i.preventDefault():i.returnValue=!1),n!==!1&&(i.stopPropagation?i.stopPropagation():i.cancelBubble=!0)}function S(e){return I.test(e)}function T(e){if(!S(e))return!0;var n=RegExp.lastMatch.length,i=e.indexOf("/",n),r=e.slice(0,-1!=i?i:t);return r.toLowerCase()==(location.protocol+"//"+location.host).toLowerCase()}function b(e,t,n){e=+e,t=t||1024;for(var i=0,a="number"==typeof t,s=1,o=r(n)?n:a?100:t.length;e>=s&&o>i;)s*=a?t:t[i],i++;return i&&s>e&&(s/=a?t:t.last(),i--),{value:i?e/s:e,level:i}}function _(e,i){if(i=i===!0?{all:!0}:i||{},isNaN(e)||e==t||0>e){var r=i.error||"--";return i.all?{text:r}:r}var a=b(e,i.steps,i.limit),s=a.value,o=s.toFixed(n(i.digit,2));return i.trim!==!1&&-1!=o.lastIndexOf(".")&&(o=o.replace(/\.?0+$/,"")),a.text=o+(i.join||"")+(i.units||C)[a.level+(i.start||0)],i.all?a:a.text}var L=Object.prototype.toString,k=Object.prototype.hasOwnProperty,O=Array.prototype.slice;s(Object,{forEach:function(e,t,n){for(var i in e)k.call(e,i)&&t.call(n,i,e[i],e)}}),s(Date,{now:function(){return+new Date}});var M;(e.ActiveXObject||e.msIndexedDB)&&(M=document.documentMode||(e.XMLHttpRequest?7:6)),e.JSON||(e.JSON={}),JSON.parse||(JSON.parse=o);var N,Q;document.addEventListener?(N=function(e,t,n){e.addEventListener(t,n,!1)},Q=function(e,t,n){e.removeEventListener(t,n,!1)}):document.attachEvent&&(N=function(e,t,n){e.attachEvent("on"+t,n)},Q=function(e,t,n){e.detachEvent("on"+t,n)});var I=/^https?:\/\//i,C=["B","KB","MB","GB","TB","PB","EB"],H={def:n,isFunc:i,isUInt:r,fire:a,extend:s,ie:M,setOpacity:l,getOffset:u,walk:c,getPrev:d,getNext:f,getFirst:p,getLast:v,getChilds:h,createEle:m,parseHTML:g,isHttpURL:S,isSameHost:T,parseLevel:b,formatSize:_};M&&(H["ie"+(6>M?6:M)]=!0),H.event={fix:y,stop:E,trigger:x,add:w},e.Q=H}(window),function(e,t){"use strict";function n(e){var t=l.Lang;switch(e){case N:return t.ready;case I:return t.processing;case C:return t.complete;case H:return t.skip;case P:return t.cancel;case z:return t.error}return e}function i(){var t=e.XMLHttpRequest;t&&(new t).upload&&e.FormData&&(b=!0);var n=document.createElement("input");n.type="file",_=!!n.files,L=b}function r(e,t){var n=e.lastIndexOf(t);return-1!=n?e.slice(n):""}function a(e){if(e){for(var t=e.split(","),n={},i=0,r=t.length;r>i;i++)n[t[i]]=!0;return n}}function s(e,t){e.attachEvent?e.attachEvent("onload",t):e.addEventListener("load",t,!1)}function o(e,t,n){if(t&&!(0>=t)){var i,r=Date.now();if(n>=t)return i=r-e.startTime,i?e.avgSpeed=Math.min(Math.round(1e3*t/i),t):e.speed||(e.avgSpeed=e.speed=t),e.time=i||0,void(e.endTime=r);i=r-e.lastTime,200>i||(e.speed=Math.min(Math.round(1e3*(n-e.loaded)/i),e.total),e.lastTime=r)}}function l(e){var t=this;t.guid=e.guid||"uploader"+ ++k,t.url=e.url,t.dataType=e.dataType||"json",t.data=e.data,t.target=e.target,t.html5=b&&!!u(e.html5,!0),t.multiple=_&&t.html5&&!!u(e.multiple,!0),t.clickTrigger=L&&!!u(e.clickTrigger,!0),t.workerThread=t.html5?e.workerThread||1:1,t.workerIdle=t.workerThread,t.auto=e.auto!==!1,t.upName=e.upName||"upfile",t.allows=a(e.allows),t.disallows=a(e.disallows),t.chunkSize=e.chunkSize||2097152,t.isSlice=!!e.isSlice,t.isQueryState=!!u(e.isQueryState,t.isSlice),t.isMd5=!!u(e.isMd5,t.isSlice),t.isUploadAfterHash=e.isUploadAfterHash!==!1,t.container=e.container||document.body,e.getPos&&(t.getPos=e.getPos);var n=e.UI||{};n.init&&(t.init=n.init),n.draw&&(t.draw=n.draw),n.update&&(t.update=n.update),n.over&&(t.over=n.over),t.fns=e.on||{},t.ops=e,t.list=[],t.map={},t.index=0,t.started=!1,t._init()}var u=Q.def,c=Q.fire,d=Q.extend,f=Q.getFirst,p=Q.getLast,v=JSON.parse,h=Q.createEle,m=Q.parseHTML,g=Q.setOpacity,y=Q.getOffset,w=Q.md5File,x=Q.event,E=x.add,S=x.trigger,T=x.stop,b=!1,_=!1,L=!1,k=0,O=0,M=0,N=0,I=1,C=2,H=-1,P=-2,z=-3;l.prototype={constructor:l,_init:function(){var e=this;if(!e._inited){e._inited=!0;var n=e.guid,i=e.target,r=e.container,a=h("div","upload-input "+n);if(r.appendChild(a),e.boxInput=a,!e.html5){var o="upload_iframe_"+n,l='<iframe class="u-iframe" name="'+o+'"></iframe><form class="u-form" action="" method="post" enctype="multipart/form-data" target="'+o+'"></form>',u=h("div","upload-html4 "+n,l);r.appendChild(u);var c=f(u),d=p(u);e.iframe=c,e.form=d,s(c,function(){if(0==e.workerIdle){var n;try{n=c.contentWindow.document.body.innerHTML}catch(i){}e.complete(t,C,n)}})}return e.clickTrigger?E(i,"click",function(t){e.fire("select",t)!==!1&&(e.resetInput(),S(e.inputFile,"click"))}):(E(a,"click",function(t){e.fire("select",t)===!1&&T(t)}),g(a,0),e.resetInput()),e.fire("init"),e.run("init")}},resetInput:function(){var e=this,t=e.boxInput;t.innerHTML='<input type="file" name="'+e.upName+'" style="'+(e.clickTrigger?"visibility: hidden;":"font-size:100px;")+'"'+(e.multiple?' multiple="multiple"':"")+">";var n=f(t);return E(n,"change",function(t){e.add(this),e.html5||e.resetInput()}),e.inputFile=n,e.updatePos()},updatePos:function(e){var t=this;if(t.clickTrigger)return t;var n=t.getPos||y,i=t.boxInput,r=f(i),a=t.target,s=a.offsetWidth,o=a.offsetHeight,l=0==s?{left:-1e4,top:-1e4}:n(a);return i.style.width=r.style.width=s+"px",i.style.height=r.style.height=o+"px",i.style.left=l.left+"px",i.style.top=l.top+"px",e&&(i.style.zIndex=++M),t},fire:function(e,t,n){if(!n)return c(this.fns[e],this,t);var i=this.fns[e+"Async"];return i?c(i,this,t,n):void n(c(this.fns[e],this,t))},run:function(e,t){var n=this[e];return n&&c(n,this,t),this},addTask:function(e,t){if(e||t){var n,i;t?(n=t.name||t.fileName,i=t.size||t.fileSize):(n=r(e.value,"\\").slice(1)||e.value,i=-1);var a=this,s=r(n,".").toLowerCase(),o=a.disallows&&a.disallows[s]||a.allows&&!a.allows[s],l={id:++O,name:n,ext:s,size:i,input:e,file:t,state:o?H:N};return o&&(l.disabled=!0),a.fire("add",l,function(e){e===!1||l.disabled||(l.index=a.list.length,a.list.push(l),a.map[l.id]=l,a.run("draw",l),a.auto&&a.start())}),l}},add:function(e){var n=this;if("INPUT"==e.tagName){var i=e.files;if(i)for(var r=0,a=i.length;a>r;r++)n.addTask(e,i[r]);else n.addTask(e)}else n.addTask(t,e)},addList:function(e){for(var t=0,n=e.length;n>t;t++)this.add(e[t])},get:function(e){return e!=t?this.map[e]:void 0},cancel:function(e,t){var n=this,i=n.get(e);if(i){var r=i.state;if(r!=N&&r!=I)return n;if(r==I){var a=i.xhr;if(a)return a.abort(),n;n.iframe.contentWindow.location="about:blank"}return t?n:n.complete(i,P)}},remove:function(e){var t=this.get(e);t&&(t.state==I&&this.cancel(e),t.deleted=!0,this.fire("remove",t))},start:function(){var e=this,t=e.workerIdle,n=e.list,i=e.index,r=n.length;if(e.started||(e.started=!0),0>=r||i>=r||0>=t)return e;var a=n[i];return e.index++,e.upload(a)},upload:function(e){var t=this;return!e||e.state!=N||e.skip?t.start():(e.url=t.url,t.workerIdle--,t.fire("upload",e,function(n){return n===!1?t.complete(e,H):void(t.html5&&e.file?t._upload_html5_ready(e):e.input?t._upload_html4(e):t.complete(e,H))}),t)},queryState:function(e,t){var n=this,i=n.url,r=new XMLHttpRequest;return e.queryUrl=i+(-1==i.indexOf("?")?"?":"&")+"action=query&hash="+(e.hash||e.name),n.fire("sliceQuery",e),r.open("GET",e.queryUrl),r.onreadystatechange=function(){if(4==r.readyState){var i,a;if(r.status>=200&&r.status<400)if(i=r.responseText,"ok"===i?a={ret:1}:i&&(a=v(i)),a&&"number"!=typeof a||(a={ret:0,start:a}),e.response=i,e.json=a,1==a.ret)e.queryOK=!0,n.cancel(e.id,!0).complete(e,C);else{var s=+a.start||0;s!=Math.floor(s)&&(s=0),e.sliceStart=s}c(t,n,r)}},r.onerror=function(){c(t,n,r)},r.send(null),n},_upload_html5_ready:function(e){var t=this,n=function(){e.state!=C&&(t.isSlice?t._upload_slice(e):t._upload_html5(e))},i=function(n){t.fire("hash",e,function(){e.hash&&t.isQueryState&&e.state!=C?t.queryState(e,n):n()})},r=function(n){if(t.isMd5&&w){var r=t.fns.hashProgress;w(e.file,function(t,r){e.hash=t,e.timeHash=r,i(n)},function(n){c(r,t,e,n)})}else i(n)};return t.isUploadAfterHash?r(n):(n(),r()),t},_process_params:function(e,t){this.data&&Object.forEach(this.data,t),e.data&&Object.forEach(e.data,t)},_upload_html5:function(e){var t=this,n=new XMLHttpRequest;e.xhr=n,n.upload.addEventListener("progress",function(n){t.progress(e,n.total,n.loaded)},!1),n.addEventListener("load",function(n){t.complete(e,C,n.target.responseText)},!1),n.addEventListener("error",function(){t.complete(e,z)},!1),n.addEventListener("abort",function(){t.complete(e,P)},!1);var i=new FormData;t._process_params(e,function(e,t){i.append(e,t)}),i.append("fileName",e.name),i.append(t.upName,e.blob||e.file,e.name),n.open("POST",e.url),t.fire("send",e,function(r){return r===!1?t.complete(e,H):(n.send(i),void t._afterSend(e))})},_upload_html4:function(e){var t=this,n=t.form,i=e.input;return i._uploaded?t.complete(e,C):(i._uploaded=!0,i.name=t.upName,n.innerHTML="",n.appendChild(i),n.action=e.url,t._process_params(e,function(e,t){n.appendChild(m('<input type="hidden" name="'+e+'" value="'+t+'">'))}),void t.fire("send",e,function(i){return i===!1?t.complete(e,H):(n.submit(),void t._afterSend(e))}))},_afterSend:function(e){e.lastTime=e.startTime=Date.now(),e.state=I,this._lastTask=e,this.progress(e)},progress:function(e,t,n){t||(t=e.size),(!n||0>n)&&(n=0);var i=e.state||N;n>t&&(n=t),n>0&&i==N&&(e.state=i=I);var r=i==C;r&&(t=n=e.size),o(e,t,n),e.total=t,e.loaded=n,this.fire("progress",e),this.run("update",e)},_process_response:function(e,t){e.response=t,t&&"json"==this.dataType&&(e.json=v(t))},complete:function(e,n,i){var r=this;return e||1!=r.workerThread||(e=r._lastTask),e&&(n!=t&&(e.state=n),e.state!=I&&n!=C||(e.state=C,r.progress(e,e.size,e.size)),i!==t&&r._process_response(e,i)),n==P&&r.fire("cancel",e),r.fire("complete",e),r.run("over",e).run("update",e),r.workerIdle++,r.started&&r.start(),r}},l.extend=function(e,t){d(l.prototype,e,t)},i(),d(l,{support:{html5:b,multiple:_},READY:N,PROCESSING:I,COMPLETE:C,SKIP:H,CANCEL:P,ERROR:z,Lang:{ready:"准备中",processing:"上传中",complete:"已完成",skip:"已跳过",cancel:"已取消",error:"已失败"},getStatusText:n}),Q.Uploader=l}(window),function(e,t){"use strict";function n(e,t){e.className+=" "+t}function i(e,t){e&&(e.innerHTML=t||"")}var r=Q.def,a=Q.getFirst,s=Q.getLast,o=Q.getNext,l=Q.createEle,u=Q.formatSize,c=Q.event,d=c.add,f=Q.Uploader;f.extend({init:function(){var e=this.ops.view;e&&n(e,this.html5?"html5":"html4")},draw:function(e){var t=this,n=t.ops,i=n.view;if(i){var o=n.button||{},u=r(o.cancel,"取消"),c=r(o.remove,"删除"),f=e.name,p='<div class="fl"><div class="u-name" title="'+f+'">'+f+'</div></div><div class="fr"><div class="u-size"></div><div class="u-speed">--/s</div><div class="u-progress-bar"><div class="u-progress" style="width:1%;"></div></div><div class="u-detail">0%</div><div class="u-state"></div><div class="u-op"><a class="u-op-cancel">'+u+'</a><a class="u-op-remove">'+c+'</a></div></div><div class="clear"></div>',v=e.id,h=l("div","u-item",p);h.taskId=v,e.box=h,i.appendChild(h);var m=s(h.childNodes[1]),g=a(m),y=s(m);d(g,"click",function(){t.cancel(v)}),d(y,"click",function(){t.remove(v),i.removeChild(h)}),t.update(e)}},update:function(e){if(e&&e.box){var n=e.total||e.size,r=e.loaded,s=e.state,l=e.box,c=l.childNodes[1],d=a(c),p=o(d),v=o(p),h=a(v),m=o(v),g=o(m);if(i(g,f.getStatusText(s)),!(0>n)){var y="";if(this.html5&&r!=t&&r>=0){var w;if(s==f.PROCESSING){var x=Math.min(100*r/n,100);w=x.toFixed(1),"100.0"==w&&(w="99.9")}else s==f.COMPLETE&&(w="100");w&&(w+="%",h.style.width=w,i(m,w)),y='<span class="u-loaded">'+u(r)+"</span> / ";var E=e.avgSpeed||e.speed;i(p,u(E)+"/s")}y+='<span class="u-total">'+u(n)+"</span>",i(d,y)}}},over:function(e){e&&e.box&&n(e.box,"u-over")}})}(window);